<!DOCTYPE html>
<!-- saved from url=(0044)https://py.mit.edu/spring22/labs/lab06/bytes -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This page was generated by CAT-SOOP 2022.2.0.dev19.  miau. -->

<title>Lab 6: Multi-Part File Downloader | 6.009 Spring 2022</title>
<link href="./Lab 6_ Bytes_files/logo.gif" rel="icon" type="image/gif">
<!-- include catsoop base css -->
<link href="./Lab 6_ Bytes_files/base.css" rel="stylesheet" type="text/css">
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    window.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });

    function clearMenu(menu){
       menu.children[1].checked = false;
    }
    // @license-end
    </script>
<!-- load in katex and CAT-SOOP-specific math rendering  -->
<script src="./Lab 6_ Bytes_files/katex.min.js.stažený soubor" type="text/javascript"></script>
<link href="./Lab 6_ Bytes_files/katex.min.css" rel="stylesheet" type="text/css">
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    catsoop.katex_macros = {};
    catsoop.render_math = function (elt) {
        var tex = elt.innerText; // TeX Source
        var display = elt.classList.contains('cs_displaymath');
        try {
            katex.render(tex, elt, {displayMode: display, macros: catsoop.katex_macros});
        }catch(e) {
            console.log(e);
            elt.innerHTML = "<font color='red'><b>Could not parse math:</b> <tt>" + tex + "</tt></font>";
        }
        elt.classList.remove('cs_math_to_render');
    }


    catsoop.render_all_math = function (elt){
        var mathelts = elt.getElementsByClassName('cs_math_to_render');
        while(mathelts.length > 0){
            catsoop.render_math(mathelts[0]);
        }
    }
    document.addEventListener("DOMContentLoaded", function(event) {
          catsoop.render_all_math(document);
    });
    // @license-end
    </script>
<!-- load in diagram stuff -->
<script src="./Lab 6_ Bytes_files/cs_diagrams.js.stažený soubor" type="text/javascript"></script>
<script type="text/javascript">
        catsoop.diagram_sources = {};
    </script>
<!-- Syntax Highlighting -->
<script src="./Lab 6_ Bytes_files/highlight.min.js.stažený soubor" type="text/javascript"></script>
<script src="./Lab 6_ Bytes_files/highlightjs-line-numbers.js.stažený soubor" type="text/javascript"></script><style type="text/css">.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    hljs.initHighlightingOnLoad();
    window.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.hl code').forEach((block) => {
            hljs.highlightBlock(block);
        });
        document.querySelectorAll('code.highlight-lines').forEach(function(b){
            hljs.lineNumbersBlock(b);
            if ((b.innerHTML.trim().match(/\r\n|\r|\n/g) || []).length > 0){
                b.parentElement.style = "padding-left: 0px !important;"
                b.classList.add('hljs');
            }
        });
    });
    // @license-end
    </script>
<style>
      :root {
        --cs-base-bg-color: #039bba;
        --cs-light-bg-color: #62d5ed;
        --cs-base-font-color: #fff;
        --cs-light-font-color: #000;
    }
    </style>
<style>
.cs_top_menu_item {
  font-size: 0.88rem;
}
div.dropdown {
  -moz-transform: translateY(-1px);
}
</style>
<script src="./Lab 6_ Bytes_files/cs_ajax.js.stažený soubor" type="text/javascript"></script>
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body style="margin: 0px;">
<header id="cs_header">
<div class="nav-container">
<div class="cs_header_text"><a href="https://py.mit.edu/spring22"><img src="./Lab 6_ Bytes_files/logo.gif">&nbsp;6.009</a></div>
<div class="dropdown" onmouseleave="clearMenu(this);">
<label class="dropbtn cs_top_menu_item" for="cs_menu_84494260bb2b4bc1ef74fe697ea810e0">Information<span class="downarrow">▼</span></label>
<input checked="false" class="dropdown-checkbox" id="cs_menu_84494260bb2b4bc1ef74fe697ea810e0" type="checkbox">
<div class="dropdown-content">
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/basics">Basic Information</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/help">Getting Help</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/grading">Grading Policies</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/academic_integrity">Academic Integrity</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/infrastructure">Infrastructure</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/notes">Course Notes</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/staff">Staff List</a></div></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/queue/">Help Queue</a>
<a class="cs_top_menu_item" href="https://discourse6009.mit.edu/">Forum</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/progress">Progress</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/labs/lab06/bytes?loginaction=login">Log In</a><a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<div class="cs_navigation cs_top_navigation" id="cs_top_navigation"><span class="line"><a href="https://py.mit.edu/spring22">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/spring22/labs/lab06">Lab 6: Multi-Part File Downloader</a></span></div>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<div class="cs_page_body">
<center><h1 class="cs_content_header">Working with Binary Data in Python</h1></center>
<div class="response" id="catsoop_login_box">
<b><center>You are not logged in.</center></b><br>
If you are a current student, please <a href="https://py.mit.edu/spring22/labs/lab06/bytes?loginaction=login">Log
In</a> for full access to the web site.<br>Note that this link will take you to
an external site (<tt>https://shimmer.mit.edu</tt>) to authenticate, and then you will be redirected
back to this page.
</div>
<p>The strings in Python that we are familiar with (the <code>str</code> type) consist of a
useful abstraction for representing text.  In particular, Python strings
represent sequences of characters (where each character represents a
<a href="https://en.wikipedia.org/wiki/Unicode">Unicode</a> character).</p>
<p>These are a useful abstraction for displaying text, but the fact that they
exist as an abstraction for the text means that they do not work as a
representation for other kinds of data, for example images or audio (since text
has a particular struture in its binary data that images or audio won't
generally have).  Ultimately, what can be stored on disk (or sent over the
network) is a series of binary values (1's and 0's).  Saving character strings
to disk, for example, requires first converting them to raw binary data first.</p>
<p>In this lab, we will be working with binary data in a variety of formats
(including not only text, but also images and audio), so we will need a
different, lower-level abstraction that lets us work directly with binary data.
Conveniently, Python offers just such an abstraction, through <em>bytestrings</em> and
<em>bytearrays</em>.</p>
<a class="anchor" name="catsoop_section_1"></a><a class="anchor" name="_byte_strings"></a><h2 class="cs_section_title">1) Byte Strings<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab06/bytes#_byte_strings">§</a></h2>
<p>Python offers a built-in type called <code>bytes</code> that represents a sequence of raw
binary data.  While this does represent a sequence of 0's and 1's; the <code>bytes</code>
type exposes those values to us not as individual <em>bits</em>, but rather as
<em>bytes</em>, each of which contains 8 bits.  As such, we can think of each byte as
representing an integer between 0 and 255 (inclusive).</p>
<p>One way to construct bytestrings is directly from arrays of integers, for example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>x = bytes([<span class="hljs-number">207</span>, <span class="hljs-number">128</span>])
<span class="hljs-meta">&gt;&gt;&gt; </span>y = bytes([<span class="hljs-number">207</span>, <span class="hljs-number">132</span>, <span class="hljs-number">32</span>, <span class="hljs-number">62</span>, <span class="hljs-number">32</span>])
</code></pre>
<p>If we print the resulting value, we see a different Python syntax for
bytestrings (which looks like a regular string, but with a <code>b</code> in front:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(x)
<span class="hljs-string">b'\xcf\x80'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(y)
<span class="hljs-string">b'\xcf\x84 &gt; '</span>
</code></pre>
<p>Note that this is not human readable like a regular Python character string.
However, it is in a format that makes it easy to directly write the data to disk,
or to send it across a network (which will be relevant for this lab!).</p>
<p>Byte strings support indexing like regular strings.  When we index into a
bytestring, we get the integer value associated with the byte at that index
(this will be an integer in the range 0 to 255, inclusive).  Similarly, looping
over a bytestring gives us integer values.</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(x[<span class="hljs-number">0</span>])
<span class="hljs-number">207</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> y:
<span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(i)
...
<span class="hljs-number">207</span>
<span class="hljs-number">132</span>
<span class="hljs-number">32</span>
<span class="hljs-number">62</span>
<span class="hljs-number">32</span>
</code></pre>
<a class="anchor" name="catsoop_section_2"></a><a class="anchor" name="_converting_between_character_strings_and_bytestrings"></a><h2 class="cs_section_title">2) Converting Between Character Strings and Bytestrings<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab06/bytes#_converting_between_character_strings_and_bytestrings">§</a></h2>
<p>As we have mentioned above, Python has two separate internal representations
for strings: character strings (<code>str</code>) and byte strings (<code>bytes</code>).  The conversion
between these is described by an <em>encoding</em> (which specifies how each character
is represented as a sequence of bytes).</p>
<p>In order to store a character string on disk, it must first be <em>encoded</em>; and
to view a human-readable form of a string that has been read from a file on
disk, it must be <em>decoded</em>.</p>
<p>There are many different possible encodings for string data (that is, given a
seequence of abstract characters, there are a number of different ways we could
choose to represent those as raw binary data).  Two of the most common encodings
are <code>ASCII</code>, <code>UTF-8</code>, and <code>UTF-16</code>.  As we can see, encoding the same string with
two different encodings gives us two different sequences of bytes:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>x = <span class="hljs-string">"Fußgänger"</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>u8 = x.encode(<span class="hljs-string">'utf-8'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>u8
<span class="hljs-string">b'Fu\xc3\x9fg\xc3\xa4nger'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>u16 = x.encode(<span class="hljs-string">'utf-16'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>u16
<span class="hljs-string">b'\xff\xfeF\x00u\x00\xdf\x00g\x00\xe4\x00n\x00g\x00e\x00r\x00'</span>
</code></pre>
<p>When decoding, we also need to know which character encoding we are using.
Trying to use the wrong encoding will either produce an unexpected answer, or
an error:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>u8.decode(<span class="hljs-string">'utf-8'</span>)
<span class="hljs-string">'Fußgänger'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>u8.decode(<span class="hljs-string">'utf-16'</span>)
Traceback (most recent call last):
  File <span class="hljs-string">"&lt;pyshell#119&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;
    u8.decode(<span class="hljs-string">'utf-16'</span>)
UnicodeDecodeError: <span class="hljs-string">'utf-16-le'</span> codec can<span class="hljs-string">'t decode byte 0x72 in position 10: truncated data
</span></code></pre>
<a class="anchor" name="catsoop_section_3"></a><a class="anchor" name="_reading_and_writing_binary_data_from_files"></a><h2 class="cs_section_title">3) Reading and Writing Binary Data From Files<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab06/bytes#_reading_and_writing_binary_data_from_files">§</a></h2>
<p>When we dealt with files in previous labs, we were making the (unstated)
assumption that the files we were working with contained textual data
(specifically, textual data encoded using the
<a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> encoding, which is a broadly-used
standard).</p>
<p>Let's see what happens when we try to open a file that does not contain
UTF-8-encoded text:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">with</span> open(<span class="hljs-string">'Havana.mp3'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:
<span class="hljs-meta">... </span>    x = f.read()
...
Traceback (most recent call last):
  File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">2</span>, <span class="hljs-keyword">in</span> &lt;module&gt;
  File <span class="hljs-string">"/usr/local/lib/python3.7/codecs.py"</span>, line <span class="hljs-number">322</span>, <span class="hljs-keyword">in</span> decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
UnicodeDecodeError: <span class="hljs-string">'utf-8'</span> codec can<span class="hljs-string">'t decode byte 0xff in position 45: invalid start byte
</span></code></pre>
<p>Indeed, we get an exception saying that Python does not know how to convert the
data in that file into a human-readable character string!  In order to grab the
data from the file, we need to tell Python to open the file in <em>binary read</em> mode
by specifying <code>'rb'</code> when opening the file:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">with</span> open(<span class="hljs-string">'Havana.mp3'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:
<span class="hljs-meta">... </span>    x = f.read()
...
</code></pre>
<p>Having done this, we have the raw binary data available to us in the variable <code>x</code>
(as a bytestring).</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>len(x)
<span class="hljs-number">3471822</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x[:<span class="hljs-number">100</span>]
<span class="hljs-string">b'ID3\x04\x00\x00\x00\x00\x00#TSSE\x00\x00\x00\x0f\x00\x00\x03Lavf57.56.101\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xfbP\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Info\x00\x00\x00\x0f\x00\x00 r\x004\xf9\xa1\x00\x02\x05'</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[:<span class="hljs-number">10</span>]:
<span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(i)
...
<span class="hljs-number">73</span>
<span class="hljs-number">68</span>
<span class="hljs-number">51</span>
<span class="hljs-number">4</span>
<span class="hljs-number">0</span>
<span class="hljs-number">0</span>
<span class="hljs-number">0</span>
<span class="hljs-number">0</span>
<span class="hljs-number">0</span>
<span class="hljs-number">35</span>
</code></pre>
<a class="anchor" name="catsoop_section_4"></a><a class="anchor" name="_representing_integers_with_bytestrings"></a><h2 class="cs_section_title" id="catsoop_label_int_as_bytes" label="int_as_bytes">4) Representing Integers with Bytestrings<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab06/bytes#_representing_integers_with_bytestrings">§</a></h2>
<p>As we mentioned above, each byte in a bytestring has a representation as an
integer in the range 0-255 (inclusive).  A few different representations for
each possible byte are shown in the table on <a href="https://py.mit.edu/spring22/labs/lab06/bytetable" target="_blank">this page</a> for reference, though it is certainly not
necessary to commit that table to memory.</p>
<p>The question might arise, though: what do we do if we want to represent a
number bigger than 255?  Clearly, one byte isn't enough in that case!  So we
need a different convention for representing larger integers.</p>
<p>In general, we can use the concatenation of multiple bytes to represent larger
integers.  In this lab, we choose a "<a href="https://en.wikipedia.org/wiki/Endianness">big-endian</a>"
representation, where the most-significant byte comes first.  By this, we mean that,
if we have a byte string containing bytes <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">b_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, and <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">b_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> (in that order),
this represents an integer:</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mn>25</mn><msup><mn>6</mn><mn>3</mn></msup><mo>×</mo><msub><mi>b</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>25</mn><msup><mn>6</mn><mn>2</mn></msup><mo>×</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>256</mn><mo>×</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">(256^3\times b_0) + (256^2\times b_1) + (256\times b_2) + b_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">25</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">25</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">256</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div><p></p>
<p>In theory, we could extend this to an arbitrary number of bytes to represent
arbitrarily-large integers.  In this lab, though, we chose to represent lengths
using 4 bytes only (though this still allows us to represent integers up to
4,294,967,295).</p>
<p>Since we can index into bytestrings to get integer values, it is possible to
compute this value directly without a complicated algorithm.  Alternatively,
you can look up the documentation for the <code>int.to_bytes</code> and <code>int.from_bytes</code>,
which will handle this conversion (in either direction).</p>
<a class="anchor" name="catsoop_section_5"></a><a class="anchor" name="_byte_arrays"></a><h2 class="cs_section_title">5) Byte Arrays<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab06/bytes#_byte_arrays">§</a></h2>
<p>It is worth noting also that the <code>bytes</code> type, like regular Python strings, is
<em>immutable</em>.  On occasion (depending on the operation you want to perform), you
may wish to work with a <em>mutable</em> array of bytes (such that you can mutate it
by changing a character in place, by appending/extending values, etc).</p>
<p>To this end, Python gives us the <code>bytearray</code> type.  You can create a
<code>bytearray</code> from a bytestring with <code>bytearray(x)</code>, or you can create an empty
<code>bytearray</code> with <code>bytearray()</code>.</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>ba = bytearray()
<span class="hljs-meta">&gt;&gt;&gt; </span>ba.extend(u8)
<span class="hljs-meta">&gt;&gt;&gt; </span>ba.extend(<span class="hljs-string">"übergänge"</span>.encode(<span class="hljs-string">'utf-8'</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span>ba
bytearray(<span class="hljs-string">b'Fu\xc3\x9fg\xc3\xa4nger\xc3\xbcberg\xc3\xa4nge'</span>)
</code></pre>
<p>Note that the elements in the <code>bytearray</code> need to be valid bytes (integers in
the range 0 to 255, inclusive).  So you can <code>extend</code> a <code>bytearray</code> by an
iterable of integers.  But if you want to append values (or modify values),
those values need to be given as integers.</p>
<p>It is worth noting, also, that <code>bytearray</code> objects can, in many ways, be
treated like <code>bytes</code> objects (for example, they provide a <code>decode</code> method:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>ba.decode(<span class="hljs-string">'utf-8'</span>)
<span class="hljs-string">'Fußgängerübergänge'</span>
</code></pre>
<p>But if you need to, you can always convert back to a <code>bytes</code> object:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>x2 = bytes(ba)
</code></pre>
<p>Just like lists vs tuples, the question of whether you want a byte string or a
byte array is heavily dependent on the application (certain operations might
only be possible on one type or the other, or certain operations might be more
efficient with one type than with the other).</p>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
catsoop.all_questions = [];
catsoop.username = null;
catsoop.this_path = 'https://py.mit.edu/spring22/labs/lab06/bytes';
catsoop.path_info = ['spring22', 'labs', 'lab06', 'bytes'];
catsoop.course = 'spring22';
catsoop.url_root = 'https://py.mit.edu';

// @license-end</script>
</div>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
<div class="cs_navigation cs_bottom_navigation" id="cs_bottom_navigation"><span class="line"><a href="https://py.mit.edu/spring22">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/spring22/labs/lab06">Lab 6: Multi-Part File Downloader</a></span></div>
<div class="cs_footer">
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu/" target="_blank">CAT-SOOP</a> v2022.2.0.dev19 "Highlander" (development snapshot).<br>
      CAT-SOOP is <a href="https://www.fsf.org/about/what-is-free-software" target="_blank">Free/Libre Software</a>, available under the terms<br>of the <a href="https://py.mit.edu/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br>
<a download="" href="https://py.mit.edu/_util/source.zip" target="_blank">Download Source Code</a><br>
<a href="https://py.mit.edu/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</div>
</footer>



</body></html>