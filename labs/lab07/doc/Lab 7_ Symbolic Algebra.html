<!DOCTYPE html>
<!-- saved from url=(0038)https://py.mit.edu/spring22/labs/lab07 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This page was generated by CAT-SOOP 2022.2.0.dev19.  miau. -->

<title>Lab 7: Symbolic Algebra | 6.009 Spring 2022</title>
<link href="./Lab 7_ Symbolic Algebra_files/logo.gif" rel="icon" type="image/gif">
<!-- include catsoop base css -->
<link href="./Lab 7_ Symbolic Algebra_files/base.css" rel="stylesheet" type="text/css">
<!-- set up JS namespace for catsoop -->
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    var catsoop = {plugins: {}};

    function toggleResponsiveHeader(){
        document.getElementsByTagName('header')[0].classList.toggle('responsive');
    }

    window.addEventListener('DOMContentLoaded', function(){
        var menu_boxes = document.getElementsByClassName('dropdown-checkbox');
        for(var i=0; i<menu_boxes.length; i++){
            menu_boxes[i].checked = false;
        }
    });

    function clearMenu(menu){
       menu.children[1].checked = false;
    }
    // @license-end
    </script>
<!-- load in katex and CAT-SOOP-specific math rendering  -->
<script src="./Lab 7_ Symbolic Algebra_files/katex.min.js.stažený soubor" type="text/javascript"></script>
<link href="./Lab 7_ Symbolic Algebra_files/katex.min.css" rel="stylesheet" type="text/css">
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    catsoop.katex_macros = {};
    catsoop.render_math = function (elt) {
        var tex = elt.innerText; // TeX Source
        var display = elt.classList.contains('cs_displaymath');
        try {
            katex.render(tex, elt, {displayMode: display, macros: catsoop.katex_macros});
        }catch(e) {
            console.log(e);
            elt.innerHTML = "<font color='red'><b>Could not parse math:</b> <tt>" + tex + "</tt></font>";
        }
        elt.classList.remove('cs_math_to_render');
    }


    catsoop.render_all_math = function (elt){
        var mathelts = elt.getElementsByClassName('cs_math_to_render');
        while(mathelts.length > 0){
            catsoop.render_math(mathelts[0]);
        }
    }
    document.addEventListener("DOMContentLoaded", function(event) {
          catsoop.render_all_math(document);
    });
    // @license-end
    </script>
<!-- load in diagram stuff -->
<script src="./Lab 7_ Symbolic Algebra_files/cs_diagrams.js.stažený soubor" type="text/javascript"></script>
<script type="text/javascript">
        catsoop.diagram_sources = {};
    </script>
<!-- Syntax Highlighting -->
<script src="./Lab 7_ Symbolic Algebra_files/highlight.min.js.stažený soubor" type="text/javascript"></script>
<script src="./Lab 7_ Symbolic Algebra_files/highlightjs-line-numbers.js.stažený soubor" type="text/javascript"></script><style type="text/css">.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style>
<script type="text/javascript">
    // @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
    hljs.initHighlightingOnLoad();
    window.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.hl code').forEach((block) => {
            hljs.highlightBlock(block);
        });
        document.querySelectorAll('code.highlight-lines').forEach(function(b){
            hljs.lineNumbersBlock(b);
            if ((b.innerHTML.trim().match(/\r\n|\r|\n/g) || []).length > 0){
                b.parentElement.style = "padding-left: 0px !important;"
                b.classList.add('hljs');
            }
        });
    });
    // @license-end
    </script>
<style>
      :root {
        --cs-base-bg-color: #039bba;
        --cs-light-bg-color: #62d5ed;
        --cs-base-font-color: #fff;
        --cs-light-font-color: #000;
    }
    </style>
<style>
.cs_top_menu_item {
  font-size: 0.88rem;
}
div.dropdown {
  -moz-transform: translateY(-1px);
}
</style>
<script src="./Lab 7_ Symbolic Algebra_files/cs_ajax.js.stažený soubor" type="text/javascript"></script>
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body style="margin: 0px;">
<header id="cs_header">
<div class="nav-container">
<div class="cs_header_text"><a href="https://py.mit.edu/spring22"><img src="./Lab 7_ Symbolic Algebra_files/logo.gif">&nbsp;6.009</a></div>
<div class="dropdown" onmouseleave="clearMenu(this);">
<label class="dropbtn cs_top_menu_item" for="cs_menu_84494260bb2b4bc1ef74fe697ea810e0">Information<span class="downarrow">▼</span></label>
<input checked="false" class="dropdown-checkbox" id="cs_menu_84494260bb2b4bc1ef74fe697ea810e0" type="checkbox">
<div class="dropdown-content">
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/basics">Basic Information</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/help">Getting Help</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/grading">Grading Policies</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/academic_integrity">Academic Integrity</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/infrastructure">Infrastructure</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/notes">Course Notes</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/info/staff">Staff List</a></div></div>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/queue/">Help Queue</a>
<a class="cs_top_menu_item" href="https://discourse6009.mit.edu/">Forum</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/progress">Progress</a>
<a class="cs_top_menu_item" href="https://py.mit.edu/spring22/labs/lab07?loginaction=login">Log In</a><a class="icon" href="javascript:void(0);" onclick="toggleResponsiveHeader()">☰</a>
</div>
</header>
<div class="cs_navigation cs_top_navigation" id="cs_top_navigation"><span class="line"><a href="https://py.mit.edu/spring22">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/spring22/labs/lab07">Lab 7: Symbolic Algebra</a></span></div>
<main class="cs_body" id="cs_body">
<div class="cs_left_menu"></div>
<div class="cs_content">
<div class="cs_page_body">
<center><h1 class="cs_content_header">Lab 7: Symbolic Algebra</h1></center>
<div class="response" id="catsoop_login_box">
<b><center>You are not logged in.</center></b><br>
If you are a current student, please <a href="https://py.mit.edu/spring22/labs/lab07?loginaction=login">Log
In</a> for full access to the web site.<br>Note that this link will take you to
an external site (<tt>https://shimmer.mit.edu</tt>) to authenticate, and then you will be redirected
back to this page.
</div>
<h2>Table of Contents</h2><ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_preparation">1) Preparation</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_introduction">2) Introduction</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_basic_symbols">3) Basic Symbols</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_binary_operations">4) Binary Operations</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_display">5) Display</a></li><ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_parenthesization">5.1) Parenthesization</a></li></ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_using_python_operators_with_symbolic_expressions">6) Using Python Operators with Symbolic Expressions</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_derivatives">7) Derivatives</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_simplification">8) Simplification</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_evaluation">9) Evaluation</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_parsing_symbolic_expressions">10) Parsing Symbolic Expressions</a></li><ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_tokenizing">10.1) Tokenizing</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_parsing">10.2) Parsing</a></li></ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_adding_an_operation">11) Adding an Operation</a></li><ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_display_2">11.1) Display</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_derivative">11.2) Derivative</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_simplify">11.3) Simplify</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_parsing_2">11.4) Parsing</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_examples">11.5) Examples</a></li></ul><li><a href="https://py.mit.edu/spring22/labs/lab07#_code_submission">12) Code Submission</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_checkoff">13) Checkoff</a></li><li><a href="https://py.mit.edu/spring22/labs/lab07#_additional_optional_extensions">14) Additional (Optional) Extensions</a></li></ul>
<a class="anchor" name="catsoop_section_1"></a><a class="anchor" name="_preparation"></a><h2 class="cs_section_title">1) Preparation<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_preparation">§</a></h2>
<div class="callout callout-note"><div class="callout-title">Note</div>
<p>You may wish to read the whole lab before implementing
any code, so that you can make a more complete plan before diving in.  Try
making a plan for your code, including the following:</p><ul>
<li>Which classes are you going to implement?  Which classes are subclasses of which classes?</li>
<li>What attributes are stored in each class?</li>
<li>What methods does each class have?</li>
</ul><p>As you work through, be on the lookout for opportunities to take advantage
of inheritance to avoid repetitious code!</p><p>Throughout the lab, you should not use Python's <code>eval</code>,
<code>exec</code>, <code>isinstance</code>, or <code>type</code> built-ins, nor should you be explicitly
checking for the type of any particular object, except where we have indicated
that it is okay to do so.  Instead of explicitly checking the types of our
objects and determining our behavior based on those results, our goal is to
use Python's own mechanism of method/attribute lookup to implement these
different behaviors without the need to do any type checking of our own.</p><p>Things that are considered "explicit type checking" include not only checks
using <code>type</code> or <code>isinstance</code>, but also storing attributes in a class (or in
all instances of a class) that uniquely identify the associated class, and
to use those pieces as a way to ask the same question one would ask of
<code>isinstance</code> or <code>type</code> (what class is this object an instance of?).</p>
</div>
<p>This lab assumes you have Python 3.6 or later installed on your machine (3.10
recommended).</p>
<p>The following file contains code and other resources as a starting point for
this lab: <a download="lab07.zip" href="https://py.mit.edu/spring22/lab_distribution.zip?path=%5B%22spring22%22%2C+%22labs%22%2C+%22lab07%22%5D"><tt>lab07.zip</tt></a></p>
<p>Most of your changes should be made to <code>lab.py</code>, which you will submit
at the end of this lab.  Importantly, you should not add any imports
to the file.</p>
<p>You can also see and participate in online discussion about this lab in the <a href="https://py.mit.edu/forum/c/labs" target="_blank">"Labs"
Category</a> in the forum.</p>
<p>This lab is worth a total of 4 points.  A substantial portion of this lab's
grade will be based on style, including avoiding explicit type checking as
described above.</p>
<p>For this lab, you will only receive credit for a test case if it runs to
completion under the time limit on the server.</p>
<div class="callout callout-error"><div class="callout-title">Academic Integrity Policy</div>
<p>Please also review the <a href="https://py.mit.edu/spring22/info/academic_integrity">academic integrity policy</a> before continuing.</p>
</div>
<p><strong>This lab does not have any questions that are due before lecture, but you are
strongly encouraged to read the specification, and perhaps to get started with
trying to implement some of the code, earlier than that.  The questions below
are all due on Friday, 8 April at 5pm Eastern.</strong></p>
<div class="callout callout-warning"><div class="callout-title">Your Checkoff This Week</div>
<p>You are not logged in.  Please log in to see information about your checkoff for this lab.</p>
</div>
<a class="anchor" name="catsoop_section_2"></a><a class="anchor" name="_introduction"></a><h2 class="cs_section_title">2) Introduction<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_introduction">§</a></h2>
<p>In this lab, we will develop a Python framework for symbolic algebra.  In such
a system, algebraic expressions including variables and numbers are not
immediately evaluated but rather are stored in symbolic form.</p>
<p>These kinds of systems abound in the "real world," and they can be incredibly
useful.  Examples of similar systems include Wolfram Alpha and <a href="https://www.sympy.org/en/index.html">Sympy</a> (a really impressive
open-source Python module for symbolic algebra).  We won't quite approach the
sophistication of those kinds of packages in this lab, but we'll get a pretty
good start in that direction!</p>
<p>We'll start by implementing support for basic arithmetic (<code>+</code>, <code>-</code>, <code>*</code>, and
<code>/</code>) on variables and numbers, and then we'll add support for simplification
and differentiation of these symbolic expressions.  Ultimately, this system
will be able to support interactions such as the following:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>x = Var(<span class="hljs-string">'x'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>y = Var(<span class="hljs-string">'y'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(x + y)
x + y
<span class="hljs-meta">&gt;&gt;&gt; </span>z = x + <span class="hljs-number">2</span>*x*y + x
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z)
x + <span class="hljs-number">2</span> * x * y + x
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'x'</span>))  <span class="hljs-comment"># derivative of z with respect to x</span>
<span class="hljs-number">1</span> + <span class="hljs-number">2</span> * x * <span class="hljs-number">0</span> + y * (<span class="hljs-number">2</span> * <span class="hljs-number">1</span> + x * <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'x'</span>).simplify())
<span class="hljs-number">1</span> + y * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'y'</span>))  <span class="hljs-comment"># derivative of z with respect to y</span>
<span class="hljs-number">0</span> + <span class="hljs-number">2</span> * x * <span class="hljs-number">1</span> + y * (<span class="hljs-number">2</span> * <span class="hljs-number">0</span> + x * <span class="hljs-number">0</span>) + <span class="hljs-number">0</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'y'</span>).simplify())
<span class="hljs-number">2</span> * x
<span class="hljs-meta">&gt;&gt;&gt; </span>z.eval({<span class="hljs-string">'x'</span>: <span class="hljs-number">3</span>, <span class="hljs-string">'y'</span>: <span class="hljs-number">7</span>})  <span class="hljs-comment"># evaluate an expression with particular values for the variables</span>
<span class="hljs-number">48</span>
</code></pre>
<a class="anchor" name="catsoop_section_3"></a><a class="anchor" name="_basic_symbols"></a><h2 class="cs_section_title">3) Basic Symbols<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_basic_symbols">§</a></h2>
<p>In this week's code distribution, we have provided a very minimal skeleton,
containing a small definition for three classes:</p>
<ul>
<li><code>Symbol</code> will be our base class; all other classes we create will inherit from this class, and any behavior that is common between all expressions (that is, all behavior that is not unique to a particular <em>kind</em> of symbolic expression) should be implemented here.</li>
<li>Instances of <code>Var</code> represent variables (such as <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> or <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span>).</li>
<li>Instances of <code>Num</code> represent numbers within symbolic expressions.</li>
</ul>
<p>Take a look at the <code>Var</code> and <code>Num</code> classes.  Note that each has <code>__init__</code>,
<code>__repr__</code>, and <code>__str__</code> defined for you already.  Importantly, while you
are welcome to add additional machinery to these objects if you want to, it
will be important that the existing instance variables continue to work as
they do in the provided skeletons (our test suite relies on this behavior).</p>
<a class="anchor" name="catsoop_section_4"></a><a class="anchor" name="_binary_operations"></a><h2 class="cs_section_title">4) Binary Operations<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_binary_operations">§</a></h2>
<p>So far, our system is somewhat uninteresting.  It lets us represent variables
and numbers, but in order to be able to represent meaningful expressions, we
also need ways of combining these primitive symbols together.  In particular,
we will represent these kinds of combinations as <em>binary operations</em>.  You
should implement a class called <code>BinOp</code> to represent a binary operation.
Because it is a type of symbolic expression, <code>BinOp</code> should be a subclass of
<code>Symbol</code>.</p>
<p>We will start with four subclasses of <code>BinOp</code>:</p>
<ul>
<li><code>Add</code>, to represent an addition</li>
<li><code>Sub</code>, to represent a subtraction</li>
<li><code>Mul</code>, to represent a multiplication</li>
<li><code>Div</code>, to represent a division</li>
</ul>
<p>By virtue of being binary operations, each instance of any of these classes
should have two instance variables:</p>
<ul>
<li><code>left</code>: a <code>Symbol</code> instance representing the left-hand operand</li>
<li><code>right</code>: a <code>Symbol</code> instance representing the right-hand operand</li>
</ul>
<p>For example, <code>Add(Add(Var('x'), Num(3)), Num(2))</code> represents the symbolic
expression <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mn>3</mn><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">x + 3 + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span>.  The <code>left</code> attribute of this instance should be the
<code>Add</code> instance <code>Add(Var('x'), Num(3))</code>, and the <code>right</code> attribute
should be the <code>Num</code> instance <code>Num(2)</code>.</p>
<p>Importantly, instances of <code>BinOp</code> (or subclasses thereof) <strong>should <em>only</em> have
these two instance attributes</strong>.  You are welcome to store additional
information in class attributes, but each instance should only store <code>left</code> and
<code>right</code>.</p>
<div class="question"><b>Check Yourself:</b><p>The structure of each of these classes' <code>__init__</code> methods is likely to be
almost the same (if not exactly the same).  What does that suggest about
how/where you should implement <code>__init__</code>?</p><p><span id="queue_checkyourself_1"></span></p></div>
<p>These constructors should also accept integers, floats, or strings as their arguments.
<code>Add(2, 'x')</code>, for example, should create an instance <code>Add(Num(2), Var('x'))</code>.
<strong>It is okay to use <code>isinstance</code> or <code>type</code> in this context, to check if the
arguments passed to the constructor are strings or numbers.</strong></p>
<a class="anchor" name="catsoop_section_5"></a><a class="anchor" name="_display"></a><h2 class="cs_section_title">5) Display<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_display">§</a></h2>
<p>As of right now, attempting to print an instance of <code>BinOp</code> (or a subclass
thereof) will not really tell us much useful information.  In this section,
we'll improve on Python's ability to display these objects.</p>
<p>Python has two different ways to get a representation of an object as
a string. First, <code>repr(obj)</code> (which calls <code>obj.__repr__()</code> under-the-hood) should
produce a string containing a representation that, when passed back into
Python, would evaluate to an equivalent object. Second, <code>str(obj)</code> (which calls
<code>obj.__str__()</code> under-the-hood) should produce a human-readable string
representation.</p>
<div class="question"><b>Check Yourself:</b><p>Take a look at the <code>__repr__</code> and <code>__str__</code> methods in <code>Var</code> and <code>Num</code>.  What
is the difference between them?</p><p><span id="queue_checkyourself_2"></span></p></div>
<p>Implement <code>__repr__</code> and <code>__str__</code> in appropriate places (avoiding repeating
code where possible), such that, for any symbolic expression <code>sym</code>, <code>repr(sym)</code>
will produce a string containing a Python expression that, when evaluated,
will result in a symbolic expression equivalent to <code>sym</code>.  Similarly, <code>str(sym)</code>
should produce a human-readable representation, given by
<code>left_string + ' ' + operand + ' ' + right_string</code>, where <code>left_string</code> and <code>right_string</code> are the
string representations of the <code>left</code> and <code>right</code> attributes, respectively, and
<code>operand</code> is a string representation of the operand associated with the
specific class in question.  For example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>z = Add(Var(<span class="hljs-string">'x'</span>), Sub(Var(<span class="hljs-string">'y'</span>), Num(<span class="hljs-number">2</span>)))
<span class="hljs-meta">&gt;&gt;&gt; </span>repr(z)  <span class="hljs-comment"># notice that this result, if fed back into Python, produces an equivalent object.</span>
<span class="hljs-string">"Add(Var('x'), Sub(Var('y'), Num(2)))"</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>str(z)  <span class="hljs-comment"># this result cannot necessarily be fed back into Python, but it looks nicer.</span>
<span class="hljs-string">'x + y - 2'</span>
</code></pre>
<p>As always, try to avoid repetitious code when implementing!  You may wish to
store additional class variables in the subclasses of <code>BinOp</code> in order to
accomplish this.  For example, we need a way to look up a string representing
the associated operator for each of the supported operations.</p>
<p><a class="anchor" name="catsoop_section_5_1"></a><a class="anchor" name="_parenthesization"></a></p><h3 class="cs_section_title">5.1) Parenthesization<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_parenthesization">§</a></h3><p></p>
<p>Note that, while a <code>__repr__</code> implementation that follows the rules described
above works well for complicated expressions (as seen in the expressions
in the last example above), a <code>__str__</code> implementation that
follows those rules results in some possible ambiguities or erroneous
interpretations.  In particular, consider the expression
<code>Mul(Var('x'), Add(Var('y'), Var('z')))</code>.  According to the rules above for
<code>__str__</code>, that
expression's string representation would be <code>"x * y + z"</code>, but the internal
structure of the expression suggests something different!  It would be nice for
the string representation instead to be <code>"x * (y + z)"</code>, to better align with the
actual structure represented by the expression.</p>
<p>To address this, we add rules for parenthesization as follows, where <code>B</code> is the <code>BinOp</code>
instance whose string representation we are finding<a class="anchor" name="catsoop_footnote_ref_1"></a><a href="https://py.mit.edu/spring22/labs/lab07#catsoop_footnote_1"><sup>1</sup></a>:</p>
<ul>
<li>If <code>B.left</code> and/or <code>B.right</code>
themselves represent expressions with lower precedence than <code>B</code>, wrap their string
representations in parentheses (here, precedence is defined using the
standard
"<a href="https://en.wikipedia.org/wiki/Order_of_operations#Mnemonics)" target="_blank">PEMDAS</a>"
ordering).</li>
<li>As a special case, if <code>B</code> represents a subtraction or a division and <code>B.right</code>
represents an expression with <em>the same precedence</em> as <code>B</code>, wrap <code>B.right</code>'s string
representation in parentheses.</li>
</ul>
<p>Individual numbers or variables should never be wrapped in parentheses.</p>
<div class="question"><b>Check Yourself:</b><p>Think about the rules for parenthesization described above in terms of algebraic expressions and
work through parenthesizing some example expressions by hand to get a feel for
how these rules work.  Do these rules seem to work in a general sense -- will they
always work across
different operations and across different levels of expression complexity?  Why do
they work?  Why are subtraction and division treated differently from addition
and multiplication?</p><p><span id="queue_checkyourself_3"></span></p></div>
<div class="question"><b>Check Yourself:</b><p></p><p>Importantly, you should implement this behavior without explicitly checking
the type of <code>self</code>, <code>self.left</code>, or <code>self.right</code>.</p>
<p>Doing so will require having a way to get information about an instance's
precedence.  How can you store this information?  And where should it be
stored?
</p><p></p><p><span id="queue_checkyourself_4"></span></p></div>
<a class="anchor" name="catsoop_section_6"></a><a class="anchor" name="_using_python_operators_with_symbolic_expressions"></a><h2 class="cs_section_title">6) Using Python Operators with Symbolic Expressions<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_using_python_operators_with_symbolic_expressions">§</a></h2>
<p>Entering expressions of the form <code>Add(Var('x'), Add(Num(3), Num(2)))</code> can get a
little bit tedious.  It would be much nicer, for example, to be able to enter
that expression as <code>Var('x') + Num(3) + Num(2)</code>.</p>
<p>Add methods to appropriate class(es) in your file such that, for any
arbitrary symbolic expressions <code>E1</code> and <code>E2</code>:</p>
<ul>
<li><code>E1 + E2</code> results in an instance <code>Add(E1, E2)</code><br>(note: you can override the behavior of <code>+</code> with the <code>__add__</code> and <code>__radd__</code> "dunder" methods)</li>
<li><code>E1 - E2</code> results in an instance <code>Sub(E1, E2)</code><br>(note: you can override the behavior of <code>-</code> with the <code>__sub__</code> and <code>__rsub__</code> "dunder" methods)</li>
<li><code>E1 * E2</code> results in an instance <code>Mul(E1, E2)</code><br>(note: you can override the behavior of <code>*</code> with the <code>__mul__</code> and <code>__rmul__</code> "dunder" methods)</li>
<li><code>E1 / E2</code> results in an instance <code>Div(E1, E2)</code><br>(note: you can override the behavior of <code>/</code> with the <code>__truediv__</code> and <code>__rtruediv__</code> "dunder" methods)</li>
</ul>
<div class="question"><b>Check Yourself:</b><p>Try to avoid duplicating code when implementing these behaviors!  In what
class(es) should you implement <code>__add__</code>?</p><p><span id="queue_checkyourself_5"></span></p></div>
<p>These behaviors should work so long as <em>at least one</em> of <code>E1</code> and <code>E2</code> is a
symbolic expression, and the other is either a symbolic expression, a number,
or a string.</p>
<p>For example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>Var(<span class="hljs-string">'a'</span>) * Var(<span class="hljs-string">'b'</span>)
Mul(Var(<span class="hljs-string">'a'</span>), Var(<span class="hljs-string">'b'</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">2</span> + Var(<span class="hljs-string">'x'</span>)
Add(Num(<span class="hljs-number">2</span>), Var(<span class="hljs-string">'x'</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span>Num(<span class="hljs-number">3</span>) / <span class="hljs-number">2</span>
Div(Num(<span class="hljs-number">3</span>), Num(<span class="hljs-number">2</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span>Num(<span class="hljs-number">3</span>) + <span class="hljs-string">'x'</span>
Add(Num(<span class="hljs-number">3</span>), Var(<span class="hljs-string">'x'</span>))
</code></pre>
<div class="callout callout-note"><div class="callout-title">Note</div>
<p>We have seen <code>__add__</code>, <code>__sub__</code>, <code>__mul__</code>, and <code>__truediv__</code> before, but
what about the versions with the <code>r</code> on the front of them?  They represent
the same operations but with the operands swapped.</p><p>It turns out that Python has a small set of rules for deciding which of
these methods to call in various situations.  For example, consider the small
expression <code>x + y</code>.  In order to decide what to do here, Python will:</p><ol>
<li>If <code>x</code> is not a built-in type, and it has an <code>__add__</code> method, invoke <code>x.__add__(y)</code>.</li>
<li>Otherwise, if <code>x</code> and <code>y</code> are of different types, and if <code>y</code> has an <code>__radd__</code> method, invoke <code>y.__radd__(x)</code>.</li>
</ol><p>In the context of our program, implementing both <code>__add__</code> and <code>__radd__</code> will allow both of the following expressions to work:</p><pre><code class="language-python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>x = Var(<span class="hljs-string">'x'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x + <span class="hljs-number">2</span>  <span class="hljs-comment"># here, __add__ will be called</span>
Add(Var(<span class="hljs-string">'x'</span>), Num(<span class="hljs-number">2</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">2</span> + x  <span class="hljs-comment"># here, __radd__ will be called</span>
Add(Num(<span class="hljs-number">2</span>), Var(<span class="hljs-string">'x'</span>))
</code></pre><p>Feel free to ask us if you have questions about this!  The page of the
Python documentation about the <a href="https://docs.python.org/3/reference/datamodel.html">Python Data
Model</a> has more information
about these methods as well.</p>
</div>
<a class="anchor" name="catsoop_section_7"></a><a class="anchor" name="_derivatives"></a><h2 class="cs_section_title">7) Derivatives<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_derivatives">§</a></h2>
<p>Next, we'll make the computer do our 18.01 homework for us.  Well, not quite.
But we'll implement support for symbolic differentiation.  In particular, we
would like to implement the following rules for partial derivatives (where <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>
is an arbitrary variable, <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">c</span></span></span></span></span> is a constant or a variable other than <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>, and
<span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">u</span></span></span></span></span> and <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span></span> are arbitrary expressions):</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}c = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}x = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mi>u</mi><mo>+</mo><mi>v</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>u</mi><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>v</mi></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}\left(u + v\right) = \frac{\partial}{\partial x}u + \frac{\partial}{\partial x}v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mi>u</mi><mo>−</mo><mi>v</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>u</mi><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>v</mi></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}\left(u - v\right) = \frac{\partial}{\partial x}u - \frac{\partial}{\partial x}v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mi>u</mi><mo>⋅</mo><mi>v</mi><mo fence="true">)</mo></mrow><mo>=</mo><mi>u</mi><mrow><mo fence="true">(</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>v</mi><mo fence="true">)</mo></mrow><mo>+</mo><mi>v</mi><mrow><mo fence="true">(</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>u</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}\left(u\cdot v\right) = u\left(\frac{\partial}{\partial x}v\right) + v\left(\frac{\partial}{\partial x}u\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">u</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></div><p></p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mi>u</mi><mi>v</mi></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>v</mi><mrow><mo fence="true">(</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>u</mi><mo fence="true">)</mo></mrow><mo>−</mo><mi>u</mi><mrow><mo fence="true">(</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>v</mi><mo fence="true">)</mo></mrow></mrow><msup><mi>v</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}\left(\frac{u}{v}\right) = \frac{v\left(\frac{\partial}{\partial x}u\right) - u\left(\frac{\partial}{\partial x}v\right)}{v^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.30612em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.62012em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.740108em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.74001em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">u</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><p></p>
<p>Even though it may not be obvious from looking at first glance, these
mathematical definitions are recursive! That is to say, partial derivatives of
compound expressions are defined in terms of partial derivatives of component
parts, which may suggest strategies for implementing these rules in your
program!</p>
<p>Implement differentiation by adding a method called <code>deriv</code> to your classes.
This method should take a single argument (a string containing the name of the
variable with respect to which we are differentiating), and it should return a
symbolic expression representing the result of the differentiation.  For example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>x = Var(<span class="hljs-string">'x'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>y = Var(<span class="hljs-string">'y'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>z = <span class="hljs-number">2</span>*x - x*y + <span class="hljs-number">3</span>*y
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'x'</span>))  <span class="hljs-comment"># unsimplified, but the following gives us (2 - y)</span>
<span class="hljs-number">2</span> * <span class="hljs-number">1</span> + x * <span class="hljs-number">0</span> - (x * <span class="hljs-number">0</span> + y * <span class="hljs-number">1</span>) + <span class="hljs-number">3</span> * <span class="hljs-number">0</span> + y * <span class="hljs-number">0</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'y'</span>))  <span class="hljs-comment"># unsimplified, but the following gives us (-x + 3)</span>
<span class="hljs-number">2</span> * <span class="hljs-number">0</span> + x * <span class="hljs-number">0</span> - (x * <span class="hljs-number">1</span> + y * <span class="hljs-number">0</span>) + <span class="hljs-number">3</span> * <span class="hljs-number">1</span> + y * <span class="hljs-number">0</span>
</code></pre>
<p>Importantly, we would like computing any derivative to result in a symbolic
expression.  Make sure that your code has this property!</p>
<a class="anchor" name="catsoop_section_8"></a><a class="anchor" name="_simplification"></a><h2 class="cs_section_title">8) Simplification<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_simplification">§</a></h2>
<p>The above code works, but it leads to output that is not very readable (it is
very difficult to see, for example, that the above examples correspond to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>−</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">2-y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span>
and <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>x</mi><mo>+</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">-x+3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span></span></span></span></span>, respectively).  To help with this, add a method called
<code>simplify</code> to your class(es).  <code>simplify</code> should take no arguments, and it
should return a simplified form of the expression, according to the following
rules:</p>
<ul>
<li>Any binary operation on two numbers should simplify to a single number containing the result.</li>
<li>Adding <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> to (or subtracting <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> from) any expression <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> should simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span>.</li>
<li>Multiplying or dividing any expression <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> by <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> should simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span>.</li>
<li>Multiplying any expression <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> by <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> should simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>.</li>
<li>Dividing <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> by any expression <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> should simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>.</li>
<li>A single number or variable always simplifies to itself.</li>
</ul>
<div class="question"><b>Check Yourself:</b><p>Think about the simplification rules described above in terms of algebraic expressions and
work through simplifying some example expressions by hand to get a feel for how
these rules work.  Do these rules seem to work in a general sense -- will they always
work across our different operations and across different levels of expression complexity,
producing sensible simplifications?
Why?</p><p><span id="queue_checkyourself_6"></span></p></div>
<div class="callout callout-error"><div class="callout-title">Note</div>
<p>Within <code>simplify</code>, you are welcome to use <code>isinstance</code> or <code>type</code> to check
whether both subexpressions of a binary operation are instances of <code>Num</code>,
or to check whether one side is equal to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> or <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>.</p>
</div>
<p>Your simplification method does not need to handle cases like <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>+</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">3 + (x + 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span>,
where the terms that could be combined are separated from each other in the
tree.  In fact, our test cases are expecting <strong>only</strong> the above rules to be
implemented.  Implementing extra rules here can be a great opportunity for
extra practice, but it will cause some test cases to fail (so maybe best to
implement such things only after submitting!).</p>
<p>For example, continuing from above:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>z = <span class="hljs-number">2</span>*x - x*y + <span class="hljs-number">3</span>*y
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.simplify())
<span class="hljs-number">2</span> * x - x * y + <span class="hljs-number">3</span> * y
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'x'</span>))
<span class="hljs-number">2</span> * <span class="hljs-number">1</span> + x * <span class="hljs-number">0</span> - (x * <span class="hljs-number">0</span> + y * <span class="hljs-number">1</span>) + <span class="hljs-number">3</span> * <span class="hljs-number">0</span> + y * <span class="hljs-number">0</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'x'</span>).simplify())
<span class="hljs-number">2</span> - y
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'y'</span>))
<span class="hljs-number">2</span> * <span class="hljs-number">0</span> + x * <span class="hljs-number">0</span> - (x * <span class="hljs-number">1</span> + y * <span class="hljs-number">0</span>) + <span class="hljs-number">3</span> * <span class="hljs-number">1</span> + y * <span class="hljs-number">0</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(z.deriv(<span class="hljs-string">'y'</span>).simplify())
<span class="hljs-number">0</span> - x + <span class="hljs-number">3</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>Add(Add(Num(<span class="hljs-number">2</span>), Num(<span class="hljs-number">-2</span>)), Add(Var(<span class="hljs-string">'x'</span>), Num(<span class="hljs-number">0</span>))).simplify()
Var(<span class="hljs-string">'x'</span>)
</code></pre>
<p>Note, also, that your <code>simplify</code> method should work by creating a new instance
to represent the simplified form, rather than mutating the instance from which
<code>simplify</code> was called.</p>
<p>And, importantly, we would like any simplification to result in a
symbolic expression.  Make sure that your code has this property!</p>
<a class="anchor" name="catsoop_section_9"></a><a class="anchor" name="_evaluation"></a><h2 class="cs_section_title">9) Evaluation<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_evaluation">§</a></h2>
<p>Next, we'll add support for evaluating expressions for particular values of
variables.  Add method(s) to your class(es) such that, for any symbolic
expression <code>sym</code>, <code>sym.eval(mapping)</code> will find a numerical value for the given
expression.  <code>mapping</code> should be a dictionary mapping variable names to values.
For example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>z = Add(Var(<span class="hljs-string">'x'</span>), Sub(Var(<span class="hljs-string">'y'</span>), Mul(Var(<span class="hljs-string">'z'</span>), Num(<span class="hljs-number">2</span>))))
<span class="hljs-meta">&gt;&gt;&gt; </span>z.eval({<span class="hljs-string">'x'</span>: <span class="hljs-number">7</span>, <span class="hljs-string">'y'</span>: <span class="hljs-number">3</span>, <span class="hljs-string">'z'</span>: <span class="hljs-number">9</span>})
<span class="hljs-number">-8</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>z.eval({<span class="hljs-string">'x'</span>: <span class="hljs-number">3</span>, <span class="hljs-string">'y'</span>: <span class="hljs-number">10</span>, <span class="hljs-string">'z'</span>: <span class="hljs-number">2</span>})
<span class="hljs-number">9</span>
</code></pre>
<p>In the test cases we'll run, the given dictionary will always contain all of
the bindings needed to evaluate the expression fully.</p>
<div class="question"><b>Check Yourself:</b><p></p><p>What should your code do in the case where the expression contains a variable
not present in the given <code>mapping</code> dictionary?</p>
<p>Think through some of the different options here, make a decision about how you
want your program to behave in that situation, and implement it.  We'll expect
you to handle this case specifically, rather than just letting Python's normal
exceptions happen.</p>
<p><strong>Be prepared to discuss your decision, as well as your code for implementing
it, during the checkoff</strong>.
</p><p></p><p><span id="queue_checkyourself_7"></span></p></div>
<a class="anchor" name="catsoop_section_10"></a><a class="anchor" name="_parsing_symbolic_expressions"></a><h2 class="cs_section_title">10) Parsing Symbolic Expressions<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_parsing_symbolic_expressions">§</a></h2>
<p>Finally, we would like to support parsing strings into symbolic expressions (to
provide yet another means of input).  For example, we would like to do
something like:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>expression(<span class="hljs-string">'(x * (2 + 3))'</span>)
Mul(Var(<span class="hljs-string">'x'</span>), Add(Num(<span class="hljs-number">2</span>), Num(<span class="hljs-number">3</span>)))
</code></pre>
<p>Define a stand-alone function called <code>expression</code>, which takes a single string as input.  This string should contain either:</p>
<ul>
<li>a single variable name,</li>
<li>a single number, or</li>
<li>a fully parenthesized expression of the form <code>(E1 op E2)</code>, representing a binary operation (where <code>E1</code> and <code>E2</code> are themselves strings representing expressions, and <code>op</code> is one of <code>+</code>, <code>-</code>, <code>*</code>, or <code>/</code>).</li>
</ul>
<p>You may assume that the string is always well-formed and fully parenthesized
(you do not need to handle erroneous input), but it should work for arbitrarily
deep nesting of expressions.</p>
<p>This process is often broken down into two pieces: <em>tokenizing</em> (to break the input string into meaningful units) and <em>parsing</em> (to build our internal representation from those units).</p>
<p><a class="anchor" name="catsoop_section_10_1"></a><a class="anchor" name="_tokenizing"></a></p><h3 class="cs_section_title">10.1) Tokenizing<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_tokenizing">§</a></h3><p></p>
<p>A good helper function to write is <code>tokenize</code>, which should take a string as
described above as input and should output a list of meaningful <em>tokens</em>
(parentheses, variable names, numbers, or operands).</p>
<p>For our purposes, you may assume that variables are always single-character
alphabetic characters and that all numbers are integers, and you may also assume
that there are spaces separating operands and operators.</p>
<p>As an example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>tokenize(<span class="hljs-string">"(x * (2 + 3))"</span>)
[<span class="hljs-string">'('</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">'*'</span>, <span class="hljs-string">'('</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'+'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">')'</span>, <span class="hljs-string">')'</span>]
</code></pre>
<p>Note that your code should also be able to handle numbers with more than one
digit and negative numbers!  A number like -200, for example, should be
represented by a single token <code>'-200'</code>.</p>
<p><a class="anchor" name="catsoop_section_10_2"></a><a class="anchor" name="_parsing"></a></p><h3 class="cs_section_title">10.2) Parsing<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_parsing">§</a></h3><p></p>
<p>Another helper function, <code>parse</code>, could take the output of <code>tokenize</code> and
convert it into an appropriate instance of <code>Symbol</code> (or some subclass thereof).
For example:</p>
<pre><code class="language-py hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>tokens = tokenize(<span class="hljs-string">"(x * (2 + 3))"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>parse(tokens)
Mul(Var(<span class="hljs-string">'x'</span>), Add(Num(<span class="hljs-number">2</span>), Num(<span class="hljs-number">3</span>)))
</code></pre>
<p>Our "little language" for representing symbolic expressions can be parsed using
a <em>recursive-descent</em> parser.  One way to structure <code>parse</code> is as follows:</p>
<pre><code class="language-py hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span>(<span class="hljs-params">tokens</span>):</span>
   <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_expression</span>(<span class="hljs-params">index</span>):</span>
       <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># your code here</span>
   parsed_expression, next_index = parse_expression(<span class="hljs-number">0</span>)
   <span class="hljs-keyword">return</span> parsed_expression
</code></pre>
<p>The function <code>parse_expression</code> is a recursive function that takes as an argument an integer indexing into the <code>tokens</code> list and returns a pair of values:</p>
<ul>
<li>the expression found starting at the location given by <code>index</code> (an instance of one of the <code>Symbol</code> subclasses), and</li>
<li>the index beyond where this expression ends (e.g., if the expression ends at the token with index <code>6</code> in the <code>tokens</code> list, then the returned value should be <code>7</code>).</li>
</ul>
<p>In the definition of this procedure, we make sure that we call it with the value <code>index</code> corresponding to the start of an expression.  So, we need to handle three cases.  Let <code>token</code> be the token at location <code>index</code>; the cases are:</p>
<ul>
<li>
<p><strong>Number</strong>: If <code>token</code> represents an integer, then make a corresponding <code>Num</code> instance and return that, paired with <code>index + 1</code> (since a number is represented by a single token).</p>
</li>
<li>
<p><strong>Variable</strong>: If <code>token</code> represents a variable name (a single alphabetic character), then make a corresponding <code>Var</code> instance and return that, paired with <code>index + 1</code> (since a variable is represented by a single token).</p>
</li>
<li>
<p><strong>Operation</strong>: Otherwise, the sequence of tokens starting at <code>index</code> must be of the form: <code>(E1 op E2)</code>.  Therefore, <code>token</code> must be <code>(</code>.  In this case, we need to recursively parse the two subexpressions, combine them into an appropriate instance of a subclass of <code>BinOp</code> (determined by <code>op</code>), and return that instance, along with the index of the token beyond the final right parenthesis.</p>
</li>
</ul>
<p>Implement the <code>expression</code> function in your code (possibly using the helper functions
described above).  <strong>Your implementation of the function <code>expression</code> should not use
Python's built-in <code>eval</code>, <code>exec</code>, <code>type</code>, or <code>isinstance</code> functions.</strong></p>
<a class="anchor" name="catsoop_section_11"></a><a class="anchor" name="_adding_an_operation"></a><h2 class="cs_section_title">11) Adding an Operation<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_adding_an_operation">§</a></h2>
<p>One of our main goals with the structure above was to set things up so that
our esystem is <em>extensible</em>, in the sense that making a change (like adding an
operation) is relatively easy and doesn't require making sweeping changes to a
lot of different parts of our code.</p>
<p>Now we'll put that to the test by augmenting our system to add another
binary operation: exponentiation.  Implement a new class <code>Pow</code> that implements
exponentiation.  You should also implement the associated <code>__pow__</code> and
<code>__rpow__</code> methods for your existing symbols, so that we can use the <code>**</code>
operator on two arbitrary symbols to create new <code>Pow</code> instances.</p>
<p>This new operation should behave as described below.</p>
<p><a class="anchor" name="catsoop_section_11_1"></a><a class="anchor" name="_display_2"></a></p><h3 class="cs_section_title">11.1) Display<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_display_2">§</a></h3><p></p>
<p>In your <code>__str__</code> implementation, note that exponentiation has its own unique
rules for parenthesization.</p>
<p>A <code>Pow</code> instance should follow normal rules for parenthesization, but it should
also wrap its <code>left</code> subexpression in parentheses if <code>left</code>'s precedence is
less than <strong>or equal to</strong> its own precedence.</p>
<p><a class="anchor" name="catsoop_section_11_2"></a><a class="anchor" name="_derivative"></a></p><h3 class="cs_section_title">11.2) Derivative<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_derivative">§</a></h3><p></p>
<p>For simplicity's sake, we will only allow computing the derivative of a <code>Pow</code>
instance if its <code>right</code> attribute is an instance of <code>Num</code>, in which case we
can apply the following rule:</p>
<p></p><div class="cs_displaymath" style="text-align:center;padding-bottom:10px;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mrow><mo fence="true">(</mo><msup><mi>u</mi><mi>n</mi></msup><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mi>n</mi><msup><mi>u</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mi>u</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial x}\left(u^n\right) = \left(nu^{n-1}\right)\left({\partial\over \partial x}u\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord mathnormal">u</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></div><p></p>
<p>If we try to compute the derivative of a <code>Pow</code> instance whose <code>right</code> attribute
is not a <code>Num</code> instance, we should raise a <code>TypeError</code> with a descriptive error
message (and it is OK to use an explicit type check to determine whether this
is the case).</p>
<p><a class="anchor" name="catsoop_section_11_3"></a><a class="anchor" name="_simplify"></a></p><h3 class="cs_section_title">11.3) Simplify<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_simplify">§</a></h3><p></p>
<p>We'll also implement two new simplification rules for exponentiation:</p>
<ul>
<li>Any expression raised to the power <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> should simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>.</li>
<li>Any expression raised to the power <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> should simplify to itself.</li>
<li><span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> raised to any positive power (or to any other symbolic expression that is not a single number) should simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>.</li>
</ul>
<p><a class="anchor" name="catsoop_section_11_4"></a><a class="anchor" name="_parsing_2"></a></p><h3 class="cs_section_title">11.4) Parsing<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_parsing_2">§</a></h3><p></p>
<p>Your <code>expression</code> function should be able to handle exponentiation using the <code>**</code>
operator.</p>
<p><a class="anchor" name="catsoop_section_11_5"></a><a class="anchor" name="_examples"></a></p><h3 class="cs_section_title">11.5) Examples<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_examples">§</a></h3><p></p>
<p>Here are some examples of symbolic expressions involving <code>Pow</code>:</p>
<pre><code class="language-python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">2</span> ** Var(<span class="hljs-string">'x'</span>)
Pow(Num(<span class="hljs-number">2</span>), Var(<span class="hljs-string">'x'</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span>x = expression(<span class="hljs-string">'(x ** 2)'</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.deriv(<span class="hljs-string">'x'</span>)
Mul(Mul(Num(<span class="hljs-number">2</span>), Pow(Var(<span class="hljs-string">'x'</span>), Sub(Num(<span class="hljs-number">2</span>), Num(<span class="hljs-number">1</span>)))), Num(<span class="hljs-number">1</span>))
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(x.deriv(<span class="hljs-string">'x'</span>).simplify())
<span class="hljs-number">2</span> * x
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(Pow(Add(Var(<span class="hljs-string">'x'</span>), Var(<span class="hljs-string">'y'</span>)), Num(<span class="hljs-number">1</span>)))
(x + y) ** <span class="hljs-number">1</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(Pow(Add(Var(<span class="hljs-string">'x'</span>), Var(<span class="hljs-string">'y'</span>)), Num(<span class="hljs-number">1</span>)).simplify())
x + y
</code></pre>
<a class="anchor" name="catsoop_section_12"></a><a class="anchor" name="_code_submission"></a><h2 class="cs_section_title">12) Code Submission<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_code_submission">§</a></h2>
<p>When you have tested your code sufficiently on your own machine, submit your
modified <code>lab.py</code> using the <code>submit-009-lab</code> script.  The following command
should submit the lab, assuming that the last argument <code>/path/to/lab.py</code> is
replaced by the location of your <code>lab.py</code> file:</p>
<pre><code class="language-nohighlight">$ submit-009-lab -a lab07 /path/to/lab.py
</code></pre>
<p>Running that script should submit your file to be checked, and it should also
provide some information about how and where to get feedback about your
submission.  Reloading this page after submitting will also show some
additional information:</p>
<div class="callout callout-note">You have not yet made any submissions to this assignment.</div>
<a class="anchor" name="catsoop_section_13"></a><a class="anchor" name="_checkoff"></a><h2 class="cs_section_title">13) Checkoff<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_checkoff">§</a></h2>
<p>Once you are finished with the code, please come to office hours
and add yourself to the queue asking for a checkoff.  <strong>You must be
ready to discuss your code and test cases in detail before asking for a checkoff.</strong></p>
<p>You should be prepared to demonstrate your code (which should be
well-commented, should avoid repetition, and should make good use of helper
functions).  In particular:</p>
<ul>
<li>Briefly describe your implementation of parenthesization.  How did you use inheritance to avoid repetitious code and to avoid explicitly checking the type of any of the objects?</li>
<li>Describe your implementation of the <code>eval</code> method.  How does your code handle the case where not all of the necessary variables are specified?</li>
<li>Describe your process for adding the <code>Pow</code> class.  What pieces of your code needed to change to make this addition?</li>
<li>Briefly describe why we wanted to avoid explicitly checking types throughout the lab.</li>
<li>Demonstrate using your code to simulate some symbolic algebra problems of your own choosing that demonstrate all of the functionality in the lab.</li>
</ul>
<div class="response"><i>You have not yet received this checkoff.</i></div>
<a class="anchor" name="catsoop_section_14"></a><a class="anchor" name="_additional_optional_extensions"></a><h2 class="cs_section_title">14) Additional (Optional) Extensions<a class="cs_permalink" href="https://py.mit.edu/spring22/labs/lab07#_additional_optional_extensions">§</a></h2>
<p>We think the program we've built here is pretty impressive!  But there are many
opportunities to improve and/or extend its behavior to do even more impressive
things.  If you have the time and interest, there are a number of ways that you
could expand on this framework, including (but not limited to):</p>
<ul>
<li>
<p>adding additional operations, including support for derivatives, simplification, etc.</p>
</li>
<li>
<p>adding additional rules for simplification similar to those we've seen above (for example, for any expression <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">u</span></span></span></span></span>, <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi mathvariant="normal">/</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">u/u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">u</span><span class="mord">/</span><span class="mord mathnormal">u</span></span></span></span></span> could simplify to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>)</p>
</li>
<li>
<p>adding support for <a href="https://py.mit.edu/spring22/labs/lab07/solver">solving systems of linear equations</a></p>
</li>
<li>
<p>modifying your code to be able to handle situations like <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>+</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">3 + (x+2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span>, where simplification is possible in theory, but where the methods described above won't fully simplify the expression</p>
</li>
<li>
<p>adding more simplification rules relating addition to multiplication, or multiplication to exponentiation.  For example, could we simplify <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>x</mi><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">x + x + x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>x</mi></mrow><annotation encoding="application/x-tex">3x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span><span class="mord mathnormal">x</span></span></span></span></span>, or <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>4</mn><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3y)(4y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">4</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> to <span class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">12y^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mord">12</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> ?</p>
</li>
<li>
<p>adding representations for polynomial expressions, which may provide additional opportunities for simplification</p>
</li>
<li>
<p>modifying your linear equation solver so that it outputs partial results even for systems that can't be solved (i.e., for systems that are underconstrained)</p>
</li>
</ul>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3
catsoop.all_questions = [];
catsoop.username = null;
catsoop.this_path = 'https://py.mit.edu/spring22/labs/lab07';
catsoop.path_info = ['spring22', 'labs', 'lab07'];
catsoop.course = 'spring22';
catsoop.url_root = 'https://py.mit.edu';

// @license-end</script>
<br>&nbsp;<hr><b name="cs_footnotes">Footnotes</b><p><a class="anchor" name="catsoop_footnote_1"></a><sup style="padding-right:0.25em;color:var(--cs-base-bg-color);">1</sup>Note that these
rules should be sufficient for the four operations we have implemented.  If we
wanted to add additional operations, we may need to reconsider these
rules. <a href="https://py.mit.edu/spring22/labs/lab07#catsoop_footnote_ref_1"><span class="noprint">(click to return to text)</span></a></p>
</div>
</div>
<div class="cs_right_menu"></div>
</main>
<footer>
<div class="cs_navigation cs_bottom_navigation" id="cs_bottom_navigation"><span class="line"><a href="https://py.mit.edu/spring22">Home</a></span> <span class="cs_nav_separator">/</span> <span class="line"><a href="https://py.mit.edu/spring22/labs/lab07">Lab 7: Symbolic Algebra</a></span></div>
<div class="cs_footer">
      This page was last updated on Saturday April 02, 2022 at 05:35:12 PM (revision <code>4c84e24d6</code>).<br>&nbsp;<br>
<pre class="catsooplogo" style="font-size:50%;">\            
/    /\__/\  
\__=(  o_O )=
(__________) 
 |_ |_ |_ |_ </pre>
      Powered by <a href="https://catsoop.mit.edu/" target="_blank">CAT-SOOP</a> v2022.2.0.dev19 "Highlander" (development snapshot).<br>
      CAT-SOOP is <a href="https://www.fsf.org/about/what-is-free-software" target="_blank">Free/Libre Software</a>, available under the terms<br>of the <a href="https://py.mit.edu/_util/license" target="_blank">GNU Affero General Public License, version 3</a>.<br>
<a download="" href="https://py.mit.edu/_util/source.zip" target="_blank">Download Source Code</a><br>
<a href="https://py.mit.edu/_util/jslicense.html" rel="jslicense" target="_blank">Javascript License Information</a>
</div>
</footer>



</body></html>